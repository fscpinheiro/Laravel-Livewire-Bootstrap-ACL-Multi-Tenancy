!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):((e="undefined"!=typeof globalThis?globalThis:e||self).FormValidation=e.FormValidation||{},e.FormValidation.plugins=e.FormValidation.plugins||{},e.FormValidation.plugins.AutoFocus=t())}(this,function(){"use strict";function e(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){return t.__proto__=n,t})(e,t)}function l(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e){var t=function e(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function n(){var i,a=o(e);if(t){var r=o(this).constructor;i=Reflect.construct(a,arguments,r)}else i=a.apply(this,arguments);return function e(t,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw TypeError("Derived constructors may only return object or undefined");return l(t)}(this,i)}}var d=FormValidation.Plugin,s=function(t){i(a,t);var o=r(a);function a(t){var n;return e(this,a),(n=o.call(this,t)).statuses=new Map,n.opts=Object.assign({},{onStatusChanged:function e(){}},t),n.elementValidatingHandler=n.onElementValidating.bind(l(n)),n.elementValidatedHandler=n.onElementValidated.bind(l(n)),n.elementNotValidatedHandler=n.onElementNotValidated.bind(l(n)),n.elementIgnoredHandler=n.onElementIgnored.bind(l(n)),n.fieldAddedHandler=n.onFieldAdded.bind(l(n)),n.fieldRemovedHandler=n.onFieldRemoved.bind(l(n)),n}return n(a,[{key:"install",value:function e(){this.core.on("core.element.validating",this.elementValidatingHandler).on("core.element.validated",this.elementValidatedHandler).on("core.element.notvalidated",this.elementNotValidatedHandler).on("core.element.ignored",this.elementIgnoredHandler).on("core.field.added",this.fieldAddedHandler).on("core.field.removed",this.fieldRemovedHandler)}},{key:"uninstall",value:function e(){this.statuses.clear(),this.core.off("core.element.validating",this.elementValidatingHandler).off("core.element.validated",this.elementValidatedHandler).off("core.element.notvalidated",this.elementNotValidatedHandler).off("core.element.ignored",this.elementIgnoredHandler).off("core.field.added",this.fieldAddedHandler).off("core.field.removed",this.fieldRemovedHandler)}},{key:"areFieldsValid",value:function e(){return Array.from(this.statuses.values()).every(function(e){return"Valid"===e||"NotValidated"===e||"Ignored"===e})}},{key:"getStatuses",value:function e(){return this.statuses}},{key:"onFieldAdded",value:function e(t){this.statuses.set(t.field,"NotValidated")}},{key:"onFieldRemoved",value:function e(t){this.statuses.has(t.field)&&this.statuses.delete(t.field),this.opts.onStatusChanged(this.areFieldsValid())}},{key:"onElementValidating",value:function e(t){this.statuses.set(t.field,"Validating"),this.opts.onStatusChanged(!1)}},{key:"onElementValidated",value:function e(t){this.statuses.set(t.field,t.valid?"Valid":"Invalid"),t.valid?this.opts.onStatusChanged(this.areFieldsValid()):this.opts.onStatusChanged(!1)}},{key:"onElementNotValidated",value:function e(t){this.statuses.set(t.field,"NotValidated"),this.opts.onStatusChanged(!1)}},{key:"onElementIgnored",value:function e(t){this.statuses.set(t.field,"Ignored"),this.opts.onStatusChanged(this.areFieldsValid())}}]),a}(d);return function(t){i(a,t);var o=r(a);function a(t){var n;return e(this,a),(n=o.call(this,t)).fieldStatusPluginName="___autoFocusFieldStatus",n.opts=Object.assign({},{onPrefocus:function e(){}},t),n.invalidFormHandler=n.onFormInvalid.bind(l(n)),n}return n(a,[{key:"install",value:function e(){this.core.on("core.form.invalid",this.invalidFormHandler).registerPlugin(this.fieldStatusPluginName,new s)}},{key:"uninstall",value:function e(){this.core.off("core.form.invalid",this.invalidFormHandler).deregisterPlugin(this.fieldStatusPluginName)}},{key:"onFormInvalid",value:function e(){var t=this.core.getPlugin(this.fieldStatusPluginName).getStatuses(),n=Object.keys(this.core.getFields()).filter(function(e){return"Invalid"===t.get(e)});if(n.length>0){var i=n[0],o=this.core.getElements(i);if(o.length>0){var a=o[0],l={firstElement:a,field:i};this.core.emit("plugins.autofocus.prefocus",l),this.opts.onPrefocus(l),a.focus()}}}}]),a}(d)});